{% extends "base.html" %}
{% load static %}

{% block extra_css %}
{{ block.super }}
<link rel="stylesheet" href="{% static 'tabipre/css/old_template/create_link.css' %}">
{% endblock %}

{% block content %}
<div class="container mt-5">

  <h3 class="sub-title mb-5">ãƒªãƒ³ã‚¯ã®å…±æœ‰</h3>

  <form method="post">
    {% csrf_token %}

    <!-- æ¨©é™è¨­å®š -->
    <div class="mb-4">
      <label class="form-label fw-bold">æ¨©é™ã®è¨­å®š</label>
      {{ form.permission_type }}

      {% if form.permission_type.errors %}
        <div class="text-danger small">{{ form.permission_type.errors.0 }}</div>
      {% endif %}
    </div>

    <!-- æœ‰åŠ¹æœŸé™è¨­å®š -->
    <label class="form-label fw-bold">æœ‰åŠ¹æœŸé™ã®è¨­å®š</label>

    <div class="mb-3">

      <!-- 0: 1ã‹æœˆé–“æœ‰åŠ¹ -->
      <div class="radio-inline mt-2">
        <label>
          <input type="radio" name="expiration_type" value="0"
                 {% if form.data.expiration_type == "0" or form.initial.expiration_type == 0 %}checked{% endif %}>
          1ã‹æœˆé–“æœ‰åŠ¹ï¼š
          <span class="text-muted">ï¼ˆ{{ one_month_later|date:"Y.n.j" }} ã¾ã§ï¼‰</span>
        </label>
      </div>

      <!-- 1: æ—…è¡Œçµ‚äº†æ—¥ã®ç¿Œæ—¥ã¾ã§ -->
      <div class="radio-inline mt-2">
        <label>
          <input type="radio" name="expiration_type" value="1"
                 {% if form.data.expiration_type == "1" or form.initial.expiration_type == 1 %}checked{% endif %}>
          æ—…è¡Œçµ‚äº†æ—¥ã®ç¿Œæ—¥ã¾ã§ï¼š
          <span class="text-muted">ï¼ˆ{{ next_day|date:"Y.n.j" }} ã¾ã§ï¼‰</span>
        </label>
      </div>

      <!-- 2: æ—¥ä»˜ã‚’æŒ‡å®šã™ã‚‹ -->
      <div class="radio-inline mt-2">
        <label>
          <input type="radio" name="expiration_type" value="2"
                 {% if form.data.expiration_type == "2" or form.initial.expiration_type == 2 %}checked{% endif %}>
          æ—¥ä»˜ã‚’æŒ‡å®šã™ã‚‹
        </label>
      </div>

      {% if form.expiration_type.errors %}
        <div class="text-danger small">{{ form.expiration_type.errors.0 }}</div>
      {% endif %}

      <!-- æ—¥ä»˜å…¥åŠ›æ¬„ -->
      <div id="date_input_wrapper" class="mt-3" style="display:flex; gap:8px; align-items:center;">
        {{ form.expiration_date }}
        <button type="button" id="open_calendar_btn" class="btn btn-outline-secondary">ğŸ“…</button>
      </div>

      {% if form.expiration_date.errors %}
        <div class="text-danger small">{{ form.expiration_date.errors.0 }}</div>
      {% endif %}

    </div>

    <button type="submit" class="btn btn-primary w-100 mt-3">ãƒªãƒ³ã‚¯ã‚’ç™ºè¡Œ</button>
  </form>

  <div class="mt-3 text-center">
    <a href="{% url 'app:travel_detail' template.travel_info.travel_info_id %}" class="text-secondary">
      ã‚­ãƒ£ãƒ³ã‚»ãƒ«
    </a>
  </div>

</div>

{% if show_modal %}
  {% include "old_travel/modal/link_modal.html" %}
{% endif %}

{% endblock %}

{% block extra_js %}
<script>
  window.SHOW_MODAL = {{ show_modal|yesno:"true,false" }};
</script>

<script src="{% static 'tabipre/js/old_travel/create_link.js' %}"></script>
{% endblock %}